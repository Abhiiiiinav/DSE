CREATE TABLE EMP(
empcode number(3) CONSTRAINT PK_EMPNO PRIMARY KEY,
Name Varchar2(10),
Qualification Varchar2(7) CONSTRAINT Valid_Qualif Check(Qualification IN ('Btech','Mtech','Msc','Mca','Phd')),
Phone Number(10),
Email Varchar2(20) CONSTRAINT  EMAIL_DOMAIN check (Email LIKE '%@digisol.com'),
Designation Varchar2(20) CONSTRAINT VALID_DESIGNATION check (Designation IN ('Developer','Projeact Leader','Project Manager', 'Technical Head','Project Director','Project Leader','CEO')),
Salary Number(7) CONSTRAINT Salary_Range check (Salary BETWEEN 97000 AND 300000));

CREATE TABLE SKILLS(
SKILLID Char(3) CONSTRAINT UNQ_SKILLID Unique,
SKILLNAME Varchar(20) CONSTRAINT UNQ_SKILLNAME Unique);

CREATE TABLE EMP_SKILL(
EMPNO Number(3) CONSTRAINT FK_EMPNO References EMP,
SKILLID Char(3) CONSTRAINT FK_SKILLID References SKILLS(SKILLID) ON DELETE CASCADE,
SKILL_EXPERIENCE Number(3) check (SKILL_EXPERIENCE>0));

CREATE TABLE PRJ_DETAILS(
PRJID Char(3) CONSTRAINT PK_PRJID PRIMARY KEY CONSTRAINT start_p CHECK (PRJID LIKE('%p')),
PRJ_NAME varchar2(10),
START_DATE Date,
END_DATE Date,
ACTUAL_END_DATE Date,
LEAD_BY_EMPCODE Number(3) CONSTRAINT FK_LEAD_EMP References EMP,
BUDGET_ALLOCATED Number(10,1),
ACTUAL_BUDGET Number(10,1),
CONSTRAINT END_DATE_GREATER_START_DATE CHECK(END_DATE>START_DATE),
CHECK(ACTUAL_END_DATE>=END_DATE));

CREATE TABLE FAMILY_DEPENDENTS(
EMPNO Number(3) References EMP,
DEP_NAME Varchar(20),
RELATIONSHIP Varchar(16),
AGE Number(3) CONSTRAINT VALID_AGE CHECK(AGE BETWEEN 1 AND 30),
CONSTRAINT prim_k PRIMARY KEY(EMPNO,DEP_NAME));

CREATE TABLE MEDICAL_POLICY(
EMPNO Number(3) References EMP,
POLICYNO Varchar2(6) CHECK(POLICYNO LIKE('%MED')),
PREMIUM Number(5) CONSTRAINT premiumerror CHECK(PREMIUM>=0),
POLICYDATE Date,
constraint abcd Primary key(EMPNO,POLICYNO)
);



CREATE TABLE PAY_CHECK(
EMPCODE Number(3) References EMP,
PAY_DATE Date,
REGULAR_INCREMENT Number(4) CONSTRAINT VALID_REGU_INCENTIVE CHECK(REGULAR_INCREMENT IN(2000,3000,5000,7000,9000)),
Performance_incentive Number(4),
DA Number(7),
PF NUmber(6),
OTHER_INCENTIVES Number(4),
ADVANCE_TAX Number(5),
CONSTRAINT pri_key PRIMARY KEY(EMPCODE,PAY_DATE));

CREATE TABLE CLIENT(
CLIENTID Char(3) CONSTRAINT PK_CLIENTID PRIMARY KEY CONSTRAINT STRTSWITH_C CHECK(CLIENTID LIKE ('%C')),
NAME Varchar2(10),
PHONE Char(14) CONSTRAINT PHONE_FORMAT CHECK(PHONE IN('+91-%','+81-%','+31-%','+48-%','+44-%')));

CREATE TABLE WORK_EXP(
EMPCODE Number(3) References EMP,
PRJID Char(3) References PRJ_DETAILS,
WORK_EXPERIENCE Number(3) CONSTRAINT Invalid_workexp CHECK(WORK_EXPERIENCE>=0) NOT NULL,
CLIENTID Char(3) References CLIENT ON DELETE SET NULL,
RATING Char(1) CHECK(RATING IN('A','B','C')),
CONSTRAINT pri_mary PRIMARY KEY(EMPCODE,PRJID));

ALTER table EMP
add Reports_To constraint fk_reports_to_empcode references EMP(EMPCODE);

alter table SKILLS
add constraint S_ID check(SkillID like 'S%');

ALTER table EMP_SKILL
add CONSTRAINT PK_EMPNO_SKILLID Primary Key(EMPNO,SKILLID);

ALTER TABLE PRJ_DETAILS
ADD CONSTRAINT UNQ_PRJ_NAME UNIQUE(PRJ_NAME);

ALTER table CLIENT
add EMAIL Varchar2(20)
ADD CONSTRAINT VALID_EMAIL check(EMAIL LIKE '%@%.___');

Alter table EMP
add CONSTRAINT UNQ_PHONE UNIQUE(Phone);

ALTER TABLE EMP
ADD CONSTRAINT UNQ_EMAIL UNIQUE(EMAIL);

ALTER TABLE MEDICAL_POLICY
DROP CONSTRAINT abcd;
ALTER TABLE MEDICAL_POLICY
Add CONSTRAINT empnooo primary key(EMPNO,POLICYNO,POLICYDATE);

ALTER TABLE MEDICAL_POLICY
DROP CONSTRAINT premiumerror;
ALTER TABLE MEDICAL_POLICY
ADD CONSTRAINT premerror check(premium>1000);











